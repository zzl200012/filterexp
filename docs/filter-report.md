## Binary Fuse Filter Performance Report

### Build

| Rows        | Time   |
| ----------- | ------ |
| 160,000     | 4 ms   |
| 500,000     | 15 ms  |
| 1,600,000   | 51 ms  |
| 5,000,000   | 0.17 s |
| 10,000,000  | 0.36 s |
| 50,000,000  | 2 s    |
| 100,000,000 | 5 s    |

### Query

#### Single Filter Single Thread

| Rows        | Query       |
| ----------- | ----------- |
| 160,000     | 3.95 ns/op  |
| 500,000     | 4.16 ns/op  |
| 1,600,000   | 4.19 ns/op  |
| 5,000,000   | 4.64 ns/op  |
| 10,000,000  | 9.58 ns/op  |
| 50,000,000  | 23.44 ns/op |
| 100,000,000 | 27.56 ns/op |

#### Single Filter Multiple Threads

| Rows        | Query (8 threads) | Query (16 threads) |
| ----------- | ----------------- | ------------------ |
| 160,000     | 1.36 ns/op        | 1.45 ns/op         |
| 500,000     | 1.38 ns/op        | 1.48 ns/op         |
| 1,600,000   | 1.42 ns/op        | 1.50 ns/op         |
| 5,000,000   | 1.52 ns/op        | 1.58 ns/op         |
| 10,000,000  | 2.01 ns/op        | 1.92 ns/op         |
| 50,000,000  | 5.43 ns/op        | 4.73 ns/op         |
| 100,000,000 | 5.44 ns/op        | 5.24 ns/op         |

#### Multiple Filters

| Rows (Total) | 4 Filters   | 8 Filters   | 16 Filters  | 32 Filters   |
| ------------ | ----------- | ----------- | ----------- | ------------ |
| 1,600,000    | 19.03 ns/op | 37.32 ns/op | 75.34 ns/op | 152.40 ns/op |
| 5,000,000    | 20.04 ns/op | 40.62 ns/op | 82.07 ns/op | 165.20 ns/op |
| 40,000,000   | 97.84 ns/op | 197.6 ns/op | 424.2 ns/op | 825.9 ns/op  |
| 51,200,000   |             |             |             |              |

### Space

**结论：只和 entry 数目有关，每个 entry 约占 9 bit **

| Rows        | Space     |
| ----------- | --------- |
| 160,000     | 0.18 MB   |
| 500,000     | 0.55 MB   |
| 1,600,000   | 1.72 MB   |
| 5,000,000   | 5.37 MB   |
| 10,000,000  | 10.75 MB  |
| 50,000,000  | 53.69 MB  |
| 100,000,000 | 107.37 MB |

